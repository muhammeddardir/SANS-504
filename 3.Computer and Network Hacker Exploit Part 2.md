### Physical Access Attacks
- **Kon-boot :** USB boot attack where any password is accepted or correct password
- **Inception :** Unlocking a powered on and locked computer via DMA firewall/Thunderbolt
- **LAN Turtle + Responder :** USB Attack where malicious USB Ethernet adapter causes system to generate DNS Request and Responder can carputer hash.
- **Rubber Duckies :** are Humen Interface Device (HID), is automatic keyboard, can use to download and Execute malware and extract local resources, send to server
- **Defense  :**
	- Use full Disk Encryption
	- Restrict Access USB Port
	- Password Protect BIOS and Disable USB bot
	- Disable LLMNR
***
### Multipurpose NetCat : Lab 3.1
- Client Mode use to initiate Connection with specific port
- NetCat Relay
- Defense : Close unused Port
***
### Network Sniffing : Lab 3.2
- WireShark
- Tshark
- Network Manner
- Bettercap : can doing TCP modification
- ARPSpoofing : Manipulate IP to MAC 
- MITMf : can add malicious file and content into TCP, and insert malicious .hta, execute backdoor, also have module for key Logger and screenshotted
- Foiling DNS :
	- Attacker Run MITM attack to listening to DNS for victim domain.
- DNS Spoofing 
- Sniffing SSL and SSH (Dodging SSL Warning)
***
### Hijacking Attacks : Lab 3.3
**There are number of additional (other than ARP poisoning) :** on local Network (Post exploitation).
- **LLMNR  :** 
	- Responder, Can Run NBT-NS, DNS/MDNS, Attacks and Harvest Creds : HTTP/s, SQL server, Kerberos, FTP, IMAP, SMTP, DNS, LDAP : Responder can intercept the auth request.
	- Responder : It can also serve up malicious .exe file and force downgrade for LANMAN authentication (easier to crack)
- **Web Proxy Auto-Discovery (WPAD) :**  
	- MITMf, Bettercap and Responder
	- work by attempts to find system with file name of WPAD and download a PAC file with proxy settings, once we are the proxy, we can intercept and hijack web traffic.
- Defense : 
	- Activate port-level security on switches
	- use Dynamic ARP Inspection with DHCP snooping
	- Disable LLMNR and WPAD.
	- Identification : 
		- ARP entries that are incorrect broken : `arp -a`
		- Mentor Arp by ARPwatch
		- To check across network switches : Logstash CAMTableExport.ps1
		- Look at DNS Cache on windows `ipconfig /displaydns` 
	- Containment : 
		- Drop spurious session
	- Eradication :
		- change password of hijacking account
***
### Buffer Overflow
- As we know
***
### Metasploit 
- Revers VNC DLL injection
- Defense : 
	- Preparation : 
		- Keep your system patched, deploy application whitelist run
		- windows include data execution prevention (DEP) functionality 
	- Identification :
		- Unusual server crashes
		- Execution of code form stack
		- IDS/IPS alerts
	- Containment : 
		- Deploy non-executable system stacks : security measure that prevents stack memory from being used to execute code
		- Patch other systems before they get whacked
	- Recovery :
		- Carefully monitor system after it's back in production
***
### Protocol and File parser Problem
#### Protocol Parser
- A protocol parser is a software component that interprets and processes data transmitted over a network, ensuring it adheres to the rules and structure of a specific protocol, such as HTTP or TCP, for accurate communication and security.
- Types of Protocol Parsers:
	1. **HTTP Parser:** Analyzes and processes HTTP traffic.
	2. **DNS Parser:** Interprets DNS protocol for domain resolution.
	3. **SMTP Parser:** Handles email communication using the Simple Mail Transfer Protocol.
	4. **FTP Parser:** Manages file transfers through the File Transfer Protocol.
	5. **TLS/SSL Parser:** Deciphers encrypted traffic for secure communication.
	6. **VoIP Protocol Parser:** Processes voice and video communication protocols.
	7. **Custom Protocol Parser:** Designed for proprietary or specialized communication protocols.
- A protocol parser attack is a type of cyberattack that targets vulnerabilities in network protocol parsing, potentially leading to unauthorized access, data manipulation, or system compromise.
- Types of Protocol Parser Attacks:
	1. Buffer Overflow: Exploiting buffer overflows in parsers.
	2. Denial of Service (DoS): Overloading parsers to disrupt services.
	3. Injection Attacks: Injecting malicious data or code into parsing processes.
	4. Format String Attacks: Manipulating string formatting in parsers.
	5. Protocol Fuzzing: Sending malformed data to discover parser vulnerabilities.
#### File parser
- Program that Open file also can be infected of BOF
- Applications have history that infected to BOF
	- WinZip, iTunes, WordPad
	- Symantec, Trend Micro, McAfee antiviruses tool.
	- Encase and Sleuth Kit forensics.
	- Word, PowerPoint, Excel, Office tool
	- Adobe Reader, Acrobat, and Flash frequently have such flow
#### Defense
- Be Careful with Programs that parse Protocols and Files 
- Patch Software
- Pay for Sniffing tool to monitor traffic network
***
### EndPoint Security Bypass : Lab 3.4
- Macro that use technique 
- For PowerPoint use "Run_On_Open" script 
- **Use Veil tool** to generate a meterpreter Payload as a bat file to embed as word macro.
- **Ghostwriting Tool** "assembly" : Attacker can create .exe and convert to .asm then convert back to .exe, We can Convert Binary to asm by Metasploit
- **Application whitelisting**
- Additional EndPoint Security Bypass : 
	- Insert Malicious code in code caves 
	- GoLang Payload
	- Code sign your malware
	- Live Off the land (LOL) : is a technique where attackers use legitimate system tools and scripts to carry out malicious activities, making it harder to detect their actions.
***
### Workbook

**Scenario**
Alice has contacted the incident-response hotline, reporting that she's seeing unusual behavior in her desktop computer's browser. In particular, starting at around 2:30 PM on a Wednesday, she began receiving a large number of certificate warning messages that say that her browser cannot verify a certificate she is receiving from various websites using HTTPS. Worse yet, some of the sites that Alice expects to use HTTPS, including intranet SSL websites, are having all their URLS converted from https://to http://.

**Preparation**
1. As Incident Handler, you must determine which system and potentially which person may be involved in this attack.
2. Incident Response Team Collect info as ARP Caches, Switch CAM, route_arb_table, Switch CAM, DHCP logs, Organization's Asset Inventor.

**We have :**
1. Infected Machine 10.12.1.13
2. Gateway IP 10.12.1.1
3. User Alice

**Logs Collection Files we Get it from incident Response**
1. ARP Caches : `arp -a`, route_ARP_Table : `sh arp` "info about Gateway"
2. Switch CAM : Map LANs, and have info about MAC and related Port in switch 
3. DHCP Server Logs
4. Organization's Asset Inventor : Computers and owned MAC

**Last Logs Can Answer this Questions?**
1. Which machine that have lunch the attack?
2. Which person is associated with this machine?

**Investigation Steps**
1. ARP Table : 
	- Router IP 10.12.1.1 Related to MAC aa-aa-aa-aa-aa-aa : may be this MAC related to Attacker 
	- Search by MAC in Asset Inventory  file : `grep -i aa-aa-aa-aa-aa-aa asset_inventory.csv`, in Result Mac doesn't Appear, we haven't yet attacking machine
	- Since we did not find a result in the asset, this means that the router is the one that sent the ARP response, and since it does not exist in the asset, this could indicate MAC Spoofing.
2. Check Router ARP Table : `cat Router_ARP_Table.txt`, Note the Router Map MAC for 10.12.1.13 to bb:bb:bb:bb:bb:bb it's not Normal, Search by it in Asset inventory  `grep -i bb:bb:bb:bb:bb:bb asset_inventory.csv`, No Result else.
3. Know we know that there are two unusual ARP entries in this environment both associated to Alice and her Router. one of then in Alice Machine other in Router this indicate to this is double-ARP poisoning
4. CAM switch file : After Search in CAM by two MAC we fond
	1. `aaaa.aaaa.aaaa` : Related to `Fa0/15` : this is Alice MAC
	2. `bbbb.bbbb.bbbb` : Related to `Fa0/15` : this is Router MAC
	3. Note  `aaaa.aaaa.aaaa` found in Physical Switch Port `Fa0/15`, this mean the machine in this port send traffic with that source mac.
	4. Same switch port also has MAC : `bbbb.bbbb.bbbb` 
	5. Looking at CAM table we can find this port **Fa0/15** also related to this mac `000c.29ab.01f4`
	6. So we can infer this mac `000c.29ab.01f4` Lunch  Attack after search by this MAC in asset_inventory.csv we can find this MAC `000c.29ab.01f4` Related to `Thikpad T500,M2-AC23E,Vinect smith,320,00:0c:29:AB:01:F4` 
5. Additional Corroboration Evidence from DHCP by Search by MAC `000c29AB01F4` in DHCP File we can find this IP 10.12.1.47 assigned to this mac `000c29AB01F4` with user VSMITH in the same time that Alice that report it 
6. From DHCP File we can Get Alice MAC : we can see the Alice Receive DHCP lease at 2:05 PM, a little before Vincent Smith received his DHCP lease, That is machine with Vincent Smith MAC Jointed the network (and left) while Alice's Machine had a valid DHCP lease.